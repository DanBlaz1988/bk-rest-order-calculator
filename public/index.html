<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BK Rest Order Calculator</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#111a33;
      --muted:#8aa0c6;
      --text:#eaf0ff;
      --line:rgba(255,255,255,.10);
      --input:#0c1430;
      --good:rgba(56, 255, 140, .14);
      --bad:rgba(255, 80, 80, .14);
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    body{margin:0;background:radial-gradient(1100px 600px at 15% 10%, #1a2a55 0%, transparent 60%), var(--bg); color:var(--text)}
    .wrap{max-width:1100px;margin:18px auto;padding:0 12px}
    h1{margin:0 0 8px;font-size:28px;letter-spacing:.2px}
    .sub{margin:0 0 18px;color:var(--muted)}
    .top{
      display:flex;gap:12px;flex-wrap:wrap;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:14px; padding:12px;
    }
    .field{display:flex;flex-direction:column;gap:6px}
    label{font-size:12px;color:var(--muted)}
    input[type="number"]{
      width:170px; padding:10px 10px; border-radius:10px;
      border:1px solid var(--line); background:var(--input); color:var(--text);
      outline:none;
    }
    .btns{margin-left:auto;display:flex;gap:8px;align-items:flex-end}
    button{
      padding:10px 12px;border-radius:10px;border:1px solid var(--line);
      background:rgba(255,255,255,.06);color:var(--text);cursor:pointer
    }
    button:hover{background:rgba(255,255,255,.10)}
    .card{
      margin-top:14px;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line); border-radius:14px; overflow:hidden;
    }
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{
      position:sticky; top:0;
      background:rgba(10,16,32,.88);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
      color:var(--muted); font-weight:600; font-size:12px;
      padding:10px 8px; text-align:left;
      white-space:nowrap;
    }
    tbody td{
      border-bottom:1px solid rgba(255,255,255,.06);
      padding:8px;
      vertical-align:middle;
      background:rgba(255,255,255,.02);
    }
    tbody tr:hover td{background:rgba(255,255,255,.03)}
    .num{width:110px}
    .small{width:78px}
    .wide{min-width:180px}
    .cell{
      width:100%; padding:9px 8px; border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
      color:var(--text);
      outline:none;
    }
    .cell[readonly]{opacity:.85}
    .good{background:var(--good)!important;border-color:rgba(56,255,140,.25)!important}
    .bad{background:var(--bad)!important;border-color:rgba(255,80,80,.25)!important}
    .check{display:flex;align-items:center;gap:8px;white-space:nowrap;color:var(--muted);font-size:12px}
    .foot{padding:10px 12px;color:var(--muted);font-size:12px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>BK Rest Order Calculator</h1>
    <p class="sub">pro1000 method. <b>No bread/buns. No salad (Eisbergsalat)</b>.</p>

    <div class="top">
      <div class="field">
        <label>Planned Umsatz (€)</label>
        <input id="planned" type="number" step="1" value="55000" />
      </div>
      <div class="field">
        <label>Yesterday Umsatz (€)</label>
        <input id="yesterday" type="number" step="1" value="7000" />
      </div>
      <div class="btns">
        <button id="save">Save</button>
        <button id="load">Load</button>
        <button id="reset">Reset Inputs</button>
      </div>
    </div>

    <div class="card">
      <table id="tbl">
        <thead>
          <tr>
            <th class="small">Nr</th>
            <th class="wide">Item</th>
            <th class="small">Pack size</th>
            <th class="num">Yesterday used (units)</th>
            <th class="num">pro1000</th>
            <th class="num">Total stock (units)</th>
            <th class="num">Not for order (units)</th>
            <th class="num">Incoming 1 (packs)</th>
            <th class="small">Inc1</th>
            <th class="num">Incoming 2 (packs)</th>
            <th class="small">Inc2</th>
            <th class="num">Needed (units)</th>
            <th class="num">Available (units)</th>
            <th class="num">To order (packs)</th>
            <th class="num">Surplus (packs)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="foot">
        <span class="mono">pro1000 = (yesterdayUsed / yesterdayUmsatz) * 1000</span> ·
        <span class="mono">needed = plannedUmsatz * pro1000</span> ·
        <span class="mono">available = totalStock - notForOrder + (inc1*packSize*inc1on) + (inc2*packSize*inc2on)</span>
      </div>
    </div>
  </div>

<script>
  // REST ORDER ITEMS (NO buns/bread, NO Eisbergsalat)
  const ITEMS = [
    {nr:43,  name:"Long Chicken Patty", pack:112},
    {nr:50,  name:"Whopper Patty", pack:132},
    {nr:53,  name:"Crispy Chicken Patty", pack:136},
    {nr:55,  name:"Burger Patty", pack:312},
    {nr:56,  name:"King Wings", pack:325},
    {nr:57,  name:"King Nuggets", pack:568},
    {nr:60,  name:"Bacon", pack:930},
    {nr:100, name:"Pommes Frites", pack:12.5},
    {nr:107, name:"Zwiebelringe", pack:630},
    {nr:122, name:"Hot Brownie", pack:18},
    {nr:129, name:"Hot Blondie", pack:18},
    {nr:606, name:"Chilli Cheese Nuggets", pack:450},
    {nr:910, name:"Tomaten (kg)", pack:5},
    {nr:912, name:"Zwiebeln (kg)", pack:20},
    {nr:11577,name:"Mozzarella Sticks", pack:204},
    {nr:11816,name:"Chicken Tender Strips", pack:216},
    {nr:11866,name:"Gitterpommes", pack:10},
    {nr:11869,name:"Tortilla Wrap", pack:144},
    {nr:11947,name:"PlantBased WH Patty", pack:100},
    {nr:11973,name:"PlantBased Nuggets", pack:568},
    {nr:12010,name:"PlantBased HB Patty", pack:200},
    {nr:12029,name:"PlantBased Long Patty", pack:112},
    {nr:12061,name:"Premium Crunchy Chicken", pack:96},
    {nr:12110,name:"Mini Churros", pack:500},
    {nr:12180,name:"Falafel Bites", pack:249}
  ];

  const $ = (id)=>document.getElementById(id);
  const tbody = document.querySelector("#tbl tbody");

  function n(v){ return Number.isFinite(v) ? v : 0; }
  function r2(v){ return Math.round(v*100)/100; }

  function build(){
    tbody.innerHTML = "";
    ITEMS.forEach((it, idx)=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="small">${it.nr}</td>
        <td class="wide">${it.name}</td>
        <td class="small"><input class="cell" data-k="pack" data-i="${idx}" type="number" step="0.01" value="${it.pack}"></td>

        <td class="num"><input class="cell" data-k="yused" data-i="${idx}" type="number" step="0.0001" value="0"></td>
        <td class="num"><input class="cell" data-k="p1000" data-i="${idx}" type="number" step="0.0001" value="0" readonly></td>

        <td class="num"><input class="cell good" data-k="stock" data-i="${idx}" type="number" step="0.0001" value="0"></td>
        <td class="num"><input class="cell" data-k="notfor" data-i="${idx}" type="number" step="0.0001" value="0"></td>

        <td class="num"><input class="cell" data-k="inc1" data-i="${idx}" type="number" step="0.01" value="0"></td>
        <td class="small">
          <label class="check"><input data-k="inc1on" data-i="${idx}" type="checkbox" checked>1</label>
        </td>
        <td class="num"><input class="cell" data-k="inc2" data-i="${idx}" type="number" step="0.01" value="0"></td>
        <td class="small">
          <label class="check"><input data-k="inc2on" data-i="${idx}" type="checkbox">1</label>
        </td>

        <td class="num"><input class="cell" data-k="need" data-i="${idx}" type="number" step="0.0001" value="0" readonly></td>
        <td class="num"><input class="cell" data-k="avail" data-i="${idx}" type="number" step="0.0001" value="0" readonly></td>

        <td class="num"><input class="cell bad" data-k="order" data-i="${idx}" type="number" step="1" value="0" readonly></td>
        <td class="num"><input class="cell good" data-k="surplus" data-i="${idx}" type="number" step="1" value="0" readonly></td>
      `;
      tbody.appendChild(tr);
    });

    document.querySelectorAll("input").forEach(inp=>{
      inp.addEventListener("input", calcAll);
      inp.addEventListener("change", calcAll);
    });

    calcAll();
  }

  function getRow(idx){
    const get = (k) => document.querySelector(`[data-k="${k}"][data-i="${idx}"]`);
    return {
      pack: get("pack"),
      yused: get("yused"),
      p1000: get("p1000"),
      stock: get("stock"),
      notfor: get("notfor"),
      inc1: get("inc1"),
      inc1on: get("inc1on"),
      inc2: get("inc2"),
      inc2on: get("inc2on"),
      need: get("need"),
      avail: get("avail"),
      order: get("order"),
      surplus: get("surplus")
    };
  }

  function calcAll(){
    const planned = n(parseFloat($("planned").value));
    const yums = n(parseFloat($("yesterday").value));

    ITEMS.forEach((_, idx)=>{
      const row = getRow(idx);
      const pack = n(parseFloat(row.pack.value));
      const yused = n(parseFloat(row.yused.value));
      const stock = n(parseFloat(row.stock.value));
      const notfor = n(parseFloat(row.notfor.value));

      const p1000 = (yums > 0) ? (yused / yums) * 1000 : 0;
      const neededUnits = planned * p1000;

      const inc1packs = n(parseFloat(row.inc1.value));
      const inc2packs = n(parseFloat(row.inc2.value));
      const inc1on = row.inc1on.checked ? 1 : 0;
      const inc2on = row.inc2on.checked ? 1 : 0;

      const incomingUnits = (inc1packs * pack * inc1on) + (inc2packs * pack * inc2on);
      const availableUnits = stock - notfor + incomingUnits;

      const deficitUnits = Math.max(0, neededUnits - availableUnits);
      const toOrderPacks = (pack > 0) ? Math.ceil(deficitUnits / pack) : 0;

      const surplusUnits = Math.max(0, availableUnits - neededUnits);
      const surplusPacks = (pack > 0) ? Math.floor(surplusUnits / pack) : 0;

      row.p1000.value = r2(p1000);
      row.need.value = r2(neededUnits);
      row.avail.value = r2(availableUnits);
      row.order.value = toOrderPacks;
      row.surplus.value = surplusPacks;
    });
  }

  function saveState(){
    const state = {
      planned: $("planned").value,
      yesterday: $("yesterday").value,
      rows: ITEMS.map((_, idx)=>{
        const r = getRow(idx);
        return {
          pack: r.pack.value,
          yused: r.yused.value,
          stock: r.stock.value,
          notfor: r.notfor.value,
          inc1: r.inc1.value,
          inc1on: r.inc1on.checked,
          inc2: r.inc2.value,
          inc2on: r.inc2on.checked
        };
      })
    };
    localStorage.setItem("bk_rest_order_calc_v2", JSON.stringify(state));
  }

  function loadState(){
    const raw = localStorage.getItem("bk_rest_order_calc_v2");
    if(!raw) return;
    const s = JSON.parse(raw);
    $("planned").value = s.planned ?? $("planned").value;
    $("yesterday").value = s.yesterday ?? $("yesterday").value;

    (s.rows || []).forEach((v, idx)=>{
      const r = getRow(idx);
      if(!r) return;
      r.pack.value = v.pack ?? r.pack.value;
      r.yused.value = v.yused ?? r.yused.value;
      r.stock.value = v.stock ?? r.stock.value;
      r.notfor.value = v.notfor ?? r.notfor.value;
      r.inc1.value = v.inc1 ?? r.inc1.value;
      r.inc1on.checked = !!v.inc1on;
      r.inc2.value = v.inc2 ?? r.inc2.value;
      r.inc2on.checked = !!v.inc2on;
    });

    calcAll();
  }

  function resetInputs(){
    $("planned").value = 55000;
    $("yesterday").value = 7000;
    ITEMS.forEach((_, idx)=>{
      const r = getRow(idx);
      r.yused.value = 0;
      r.stock.value = 0;
      r.notfor.value = 0;
      r.inc1.value = 0;
      r.inc1on.checked = true;
      r.inc2.value = 0;
      r.inc2on.checked = false;
    });
    calcAll();
  }

  $("save").addEventListener("click", saveState);
  $("load").addEventListener("click", loadState);
  $("reset").addEventListener("click", resetInputs);

  build();
  loadState();
</script>
</body>
</html>
